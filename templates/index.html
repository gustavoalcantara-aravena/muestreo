<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Educativo: Muestreo de Se√±ales y Teorema de Nyquist-Shannon</title>
    
    <!-- Plotly.js para gr√°ficos interactivos -->
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- ==========================================
         ENCABEZADO
    ========================================== -->
    <header class="encabezado">
        <div class="contenedor-encabezado">
            <div style="font-size: 0.85em; color: #ffd700; margin-bottom: 8px; font-weight: bold;">
                üìö Comunicaciones y Redes Industriales
            </div>
            <h1>üåä Dashboard Educativo</h1>
            <p>Procesamiento Digital de Se√±ales: Muestreo y Teorema de Nyquist-Shannon</p>
        </div>
    </header>

    <!-- ==========================================
         CONTENEDOR PRINCIPAL
    ========================================== -->
    <div class="contenedor-principal">
        
        <!-- ==========================================
             PANEL DE CONTROLES (SIDEBAR)
        ========================================== -->
        <aside class="panel-controles">
            <h2>‚öôÔ∏è Controles</h2>
            
            <!-- Selector de Escenarios -->
            <div class="control-grupo escenarios-selector">
                <label for="selector-escenarios">
                    üéì Escenarios Predefinidos
                </label>
                <select id="selector-escenarios" class="selector-escenarios">
                    <option value="">-- Selecciona un escenario --</option>
                    <option value="cd-audio">üéµ CD de Audio (44.1 kHz)</option>
                    <option value="telefonia">üìû Telefon√≠a (8 kHz)</option>
                    <option value="nyquist-cumplido">‚úÖ Nyquist Cumplido</option>
                    <option value="nyquist-limite">‚ö†Ô∏è Nyquist L√≠mite</option>
                    <option value="aliasing-severo">‚ùå Aliasing Severo</option>
                    <option value="sobremuestreo">üîç Sobremuestreo</option>
                    <option value="personalizado">üéÆ Personalizado (Manual)</option>
                </select>
                <div id="descripcion-escenario" class="descripcion-escenario" style="margin-top: 8px; font-size: 0.85em; color: #666; line-height: 1.4;"></div>
            </div>

            <hr style="margin: 15px 0; border: none; border-top: 1px solid #ddd;">
            
            <!-- Amplitud -->
            <div class="control-grupo">
                <label for="amplitud">
                    üìè Amplitud
                    <span class="valor-actual" id="valor-amplitud">1.0</span>
                </label>
                <input 
                    type="range" 
                    id="amplitud" 
                    min="0.5" 
                    max="5.0" 
                    step="0.1" 
                    value="1.0"
                    class="slider"
                >
                <div class="ayuda">Altura m√°xima de la onda</div>
            </div>

            <!-- Frecuencia de la Se√±al -->
            <div class="control-grupo">
                <label for="frecuencia">
                    üì∂ Frecuencia Se√±al (f)
                    <span class="valor-actual" id="valor-frecuencia">1.0</span> Hz
                </label>
                <input 
                    type="range" 
                    id="frecuencia" 
                    min="0.5" 
                    max="5.0" 
                    step="0.1" 
                    value="1.0"
                    class="slider"
                >
                <div class="ayuda">Ciclos por segundo</div>
            </div>

            <!-- Frecuencia de Muestreo -->
            <div class="control-grupo">
                <label for="frecuencia-muestreo">
                    üìä Frecuencia Muestreo (fs)
                    <span class="valor-actual" id="valor-fs">10.0</span> Hz
                </label>
                <input 
                    type="range" 
                    id="frecuencia-muestreo" 
                    min="0.5" 
                    max="20.0" 
                    step="0.5" 
                    value="10.0"
                    class="slider"
                >
                <div class="ayuda">Muestras por segundo</div>
            </div>

            <!-- Bot√≥n Actualizar -->
            <button id="btn-actualizar" class="boton-actualizar">
                üîÑ Actualizar Gr√°fico
            </button>

            <!-- Informaci√≥n Nyquist -->
            <div class="seccion-info">
                <h3>üìö Informaci√≥n Nyquist</h3>
                <div id="info-nyquist" class="info-nyquist">
                    <p class="cargando">Cargando...</p>
                </div>
            </div>

            <!-- Explicaci√≥n Pedag√≥gica -->
            <div class="seccion-explicacion">
                <h3>üí° Conceptos Clave</h3>
                <div class="explicacion">
                    <p><strong>üìä MUESTREO:</strong></p>
                    <p style="font-size: 0.9em; margin-bottom: 8px;">Captura de valores de una se√±al continua a intervalos regulares (Ts = 1/fs)</p>
                    
                    <p><strong>üî¢ TEOREMA NYQUIST:</strong></p>
                    <p style="font-size: 0.9em; margin-bottom: 8px;">fs ‚â• 2√óf ‚Üí Reconstrucci√≥n exacta de la se√±al original</p>
                    
                    <p><strong>‚ö†Ô∏è ALIASING:</strong></p>
                    <p style="font-size: 0.9em; margin-bottom: 8px;">Error cuando fs &lt; 2√óf ‚Üí Genera frecuencia fantasma (IRREVERSIBLE)</p>
                    
                    <p><strong>üîÑ REGENERACI√ìN:</strong></p>
                    <p style="font-size: 0.9em;">Si Nyquist ‚úÖ: Se pueden interpolar los valores entre muestras usando funciones sinc</p>
                </div>
            </div>
        </aside>

        <!-- ==========================================
             √ÅREA DE GR√ÅFICOS
        ========================================== -->
        <main class="area-graficos">
            <!-- Gr√°fico 1: Se√±al Continua vs Muestras -->
            <div class="grafico-contenedor">
                <h3>üìà Se√±al Continua y Muestras Discretas</h3>
                <div id="grafico-principal" class="grafico"></div>
                <div class="leyenda-grafico">
                    <span class="leyenda-linea continua">‚îÄ Se√±al Continua (Anal√≥gica)</span>
                    <span class="leyenda-puntos">‚óè Muestras Discretas</span>
                </div>
            </div>

            <!-- Gr√°fico 2: Se√±al Alias (cuando aplica) -->
            <div class="grafico-contenedor" id="contenedor-alias" style="display: none;">
                <h3>‚ö†Ô∏è Efecto de Aliasing</h3>
                <div id="grafico-alias" class="grafico"></div>
                <div class="leyenda-grafico">
                    <span class="leyenda-linea original">‚îÄ Se√±al Original</span>
                    <span class="leyenda-linea alias">‚îÄ Se√±al Alias (Falsa)</span>
                </div>
            </div>

            <!-- Informaci√≥n T√©cnica Adicional -->
            <div class="grafico-contenedor">
                <h3>üìñ Informaci√≥n T√©cnica y Educativa</h3>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 0.95em; line-height: 1.7;">
                    
                    <details style="margin-bottom: 15px;">
                        <summary style="cursor: pointer; font-weight: bold; color: #667eea;">
                            üìä ¬øQu√© es el Muestreo?
                        </summary>
                        <div style="padding: 10px 0; margin-top: 10px; border-top: 1px solid #ddd;">
                            <p>El <strong>muestreo</strong> es el proceso de capturar valores discretos de una se√±al continua (anal√≥gica) a intervalos regulares de tiempo.</p>
                            <p style="margin-top: 8px;"><strong>Intervalo de muestreo:</strong> Ts = 1/fs (segundos)</p>
                            <p style="margin-top: 8px;"><strong>Ejemplo:</strong> En un CD de audio (fs = 44.1 kHz), se toman 44,100 muestras por segundo</p>
                        </div>
                    </details>

                    <details style="margin-bottom: 15px;">
                        <summary style="cursor: pointer; font-weight: bold; color: #667eea;">
                            üî¢ ¬øQu√© es la Cuantificaci√≥n?
                        </summary>
                        <div style="padding: 10px 0; margin-top: 10px; border-top: 1px solid #ddd;">
                            <p>La <strong>cuantificaci√≥n</strong> es el proceso de convertir las muestras (n√∫meros reales con precisi√≥n infinita) a valores discretos que puedan representarse con un n√∫mero finito de bits.</p>
                            
                            <p style="margin-top: 10px;"><strong>‚öôÔ∏è Niveles de Cuantificaci√≥n:</strong> 2^N (donde N = n√∫mero de bits)</p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li><strong>8 bits:</strong> 256 niveles (telefon√≠a, calidad baja)</li>
                                <li><strong>16 bits:</strong> 65,536 niveles (CD de audio est√°ndar)</li>
                                <li><strong>24 bits:</strong> 16.7 millones de niveles (audio profesional, Hi-Fi)</li>
                                <li><strong>32 bits:</strong> 4.3 mil millones de niveles (audio de estudio, procesamiento)</li>
                            </ul>
                            
                            <p style="margin-top: 10px;"><strong>üìè Paso de Cuantificaci√≥n (q):</strong> Diferencia m√≠nima entre niveles posibles</p>
                            <p style="margin-top: 6px; font-family: monospace; background: #e8eaf6; padding: 8px; border-radius: 4px; font-size: 0.85em;">
                                q = (V<sub>m√°x</sub> - V<sub>m√≠n</sub>) / 2^N
                            </p>
                            
                            <p style="margin-top: 10px;"><strong>‚ö†Ô∏è Error de Cuantificaci√≥n:</strong> Diferencia inevitable entre el valor real y el valor cuantificado</p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li>Rango: -q/2 a +q/2</li>
                                <li><strong>Ruido de cuantificaci√≥n:</strong> Error uniformemente distribuido</li>
                                <li>Potencia de ruido: P<sub>ruido</sub> = q¬≤ / 12</li>
                                <li><strong>IMPORTANTE:</strong> Este error es IRREVERSIBLE (no se puede eliminar despu√©s)</li>
                            </ul>
                            
                            <p style="margin-top: 10px;"><strong>üìä Relaci√≥n Se√±al-Ruido (SNR):</strong></p>
                            <p style="margin-top: 6px; font-family: monospace; background: #e8eaf6; padding: 8px; border-radius: 4px; font-size: 0.85em;">
                                SNR ‚âà 6.02 √ó N dB (para N bits)
                            </p>
                            <p style="margin-top: 6px; font-size: 0.9em;">Ejemplo: 16 bits ‚âà 96.3 dB</p>
                        </div>
                    </details>

                    <details style="margin-bottom: 15px;">
                        <summary style="cursor: pointer; font-weight: bold; color: #667eea;">
                            üîÑ ¬øC√≥mo se Regenera la Se√±al?
                        </summary>
                        <div style="padding: 10px 0; margin-top: 10px; border-top: 1px solid #ddd;">
                            <p>Si se cumple el <strong>Teorema de Nyquist</strong> (fs ‚â• 2√óf), la se√±al original se puede <strong>reconstruir perfectamente</strong> a partir de las muestras discretas.</p>
                            
                            <p style="margin-top: 10px;"><strong>üéØ Condici√≥n Fundamental:</strong></p>
                            <p style="margin-top: 6px; font-family: monospace; background: #e8eaf6; padding: 8px; border-radius: 4px; font-size: 0.85em;">
                                fs ‚â• 2 √ó f<sub>m√°x</sub> ‚Üí Reconstrucci√≥n perfecta posible
                            </p>
                            
                            <p style="margin-top: 10px;"><strong>üìê M√©todo Te√≥rico: Interpolaci√≥n Sinc</strong></p>
                            <p style="margin-top: 6px; font-size: 0.9em;">La se√±al original se recupera mediante la suma infinita:</p>
                            <p style="margin-top: 6px; font-family: monospace; background: #e8eaf6; padding: 8px; border-radius: 4px; font-size: 0.85em;">
                                x(t) = Œ£ x[n] √ó sinc(œÄ(t - nTs)/Ts)
                            </p>
                            <p style="margin-top: 6px; font-size: 0.9em;">donde sinc(x) = sin(œÄx)/(œÄx)</p>
                            
                            <p style="margin-top: 10px;"><strong>‚ö° Filtro de Reconstrucci√≥n Ideal:</strong></p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li><strong>Tipo:</strong> Filtro paso-bajo ideal</li>
                                <li><strong>Frecuencia de corte:</strong> fc = fs/2</li>
                                <li><strong>Respuesta al impulso:</strong> Funci√≥n sinc en el tiempo</li>
                                <li><strong>Efecto:</strong> Interpola perfectamente entre muestras</li>
                            </ul>
                            
                            <p style="margin-top: 10px;"><strong>‚ö†Ô∏è Limitaciones Pr√°cticas:</strong></p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li><strong>Filtro ideal no es realizable:</strong> Ser√≠a infinitamente complicado</li>
                                <li><strong>Delays inherentes:</strong> Latencia en la reconstrucci√≥n</li>
                                <li><strong>Rizado (ripple):</strong> Oscilaciones cerca de discontinuidades</li>
                                <li><strong>Error de cuantificaci√≥n:</strong> Persiste en la se√±al reconstruida</li>
                            </ul>
                            
                            <p style="margin-top: 10px;"><strong>üîå Implementaci√≥n Pr√°ctica: DAC (Digital-to-Analog Converter)</strong></p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li><strong>Paso 1 (Hold):</strong> Mantiene valor constante durante Ts</li>
                                <li><strong>Paso 2 (DAC):</strong> Convierte c√≥digo digital a voltaje anal√≥gico</li>
                                <li><strong>Paso 3 (Filtro paso-bajo):</strong> Suaviza escalonamiento (smoothing)</li>
                                <li><strong>Resultado:</strong> Aproximaci√≥n cercana a la se√±al original</li>
                            </ul>
                        </div>
                    </details>

                    <details>
                        <summary style="cursor: pointer; font-weight: bold; color: #667eea;">
                            üìê Proceso Completo: A/D ‚Üí Procesamiento ‚Üí D/A
                        </summary>
                        <div style="padding: 10px 0; margin-top: 10px; border-top: 1px solid #ddd;">
                            
                            <p style="margin-bottom: 12px;"><strong>üîó Cadena Completa de Conversi√≥n Anal√≥gica-Digital-Anal√≥gica:</strong></p>
                            
                            <p style="margin-top: 10px;"><strong>SECCI√ìN A ‚Üí D (Conversi√≥n Anal√≥gica a Digital):</strong></p>
                            <div style="margin-top: 8px; background: #fff3e0; padding: 10px; border-left: 4px solid #ff9800; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë† Filtrado Anti-Aliasing:</strong> Filtro paso-bajo anal√≥gico antes de muestrear</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ Frecuencia de corte: fs/2 (Frecuencia de Nyquist)<br>
                                    ‚Ä¢ Prop√≥sito: Eliminar componentes > fs/2 para evitar aliasing<br>
                                    ‚Ä¢ Tipo: Butterworth, Chebyshev o similar
                                </p>
                            </div>
                            
                            <div style="margin-top: 10px; background: #fff3e0; padding: 10px; border-left: 4px solid #ff9800; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë° Muestreo (Sample &amp; Hold):</strong> Captura instant√°nea de la se√±al a frecuencia fs</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ Per√≠odo: Ts = 1/fs<br>
                                    ‚Ä¢ Realiza: x[n] = x(nTs) para n = 0, 1, 2, ...<br>
                                    ‚Ä¢ Resultado: Secuencia discreta en tiempo
                                </p>
                            </div>
                            
                            <div style="margin-top: 10px; background: #fff3e0; padding: 10px; border-left: 4px solid #ff9800; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë¢ Cuantificaci√≥n (ADC):</strong> Convierte amplitudes reales a N bits (discretizaci√≥n en amplitud)</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ Niveles posibles: 2^N<br>
                                    ‚Ä¢ Resoluci√≥n: q = Rango / 2^N<br>
                                    ‚Ä¢ Error: -q/2 ‚â§ error ‚â§ +q/2
                                </p>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>SECCI√ìN DIGITAL (Procesamiento):</strong></p>
                            <div style="margin-top: 8px; background: #e3f2fd; padding: 10px; border-left: 4px solid #2196f3; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë£ Procesamiento Digital:</strong> Algoritmos, filtros, transformadas, etc.</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ FFT, convoluciones, filtros digitales<br>
                                    ‚Ä¢ Compresi√≥n, an√°lisis espectral, etc.<br>
                                    ‚Ä¢ Totalmente reversible: sin p√©rdida de precisi√≥n (excepto redondeo)
                                </p>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>SECCI√ìN D ‚Üí A (Conversi√≥n Digital a Anal√≥gica):</strong></p>
                            <div style="margin-top: 8px; background: #f3e5f5; padding: 10px; border-left: 4px solid #9c27b0; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë§ Reconstrucci√≥n (DAC):</strong> Convierte c√≥digo N-bits a voltaje anal√≥gico</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ Realiza: x(t) ‚âà Œ£ x[n] √ó rect[(t - nTs)/Ts]<br>
                                    ‚Ä¢ Produce: Escalones (step function) con pendientes verticales<br>
                                    ‚Ä¢ Limitaci√≥n: No es exactamente la sinc te√≥rica
                                </p>
                            </div>
                            
                            <div style="margin-top: 10px; background: #f3e5f5; padding: 10px; border-left: 4px solid #9c27b0; border-radius: 4px;">
                                <p style="margin: 0;"><strong>‚ë• Filtrado Post-Reconstrucci√≥n:</strong> Filtro paso-bajo anal√≥gico de salida</p>
                                <p style="margin: 6px 0 0 0; font-size: 0.9em; color: #555;">
                                    ‚Ä¢ Prop√≥sito: Suavizar escalones (smoothing filter)<br>
                                    ‚Ä¢ Frecuencia de corte: Menor a fs/2<br>
                                    ‚Ä¢ Acerca la forma a la sinc ideal<br>
                                    ‚Ä¢ Resultado: Se√±al anal√≥gica aproximada a la original
                                </p>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>üìä Diagrama Esquem√°tico:</strong></p>
                            <p style="margin-top: 8px; font-family: monospace; background: #f0f0f0; padding: 12px; border-radius: 4px; font-size: 0.85em; overflow-x: auto; line-height: 1.6;">
x(t) ‚Üí [AA Filt] ‚Üí [S&H] ‚Üí [ADC] ‚Üí [DIGITAL] ‚Üí [DAC] ‚Üí [AA Filt] ‚Üí x'(t)<br>
&nbsp;&nbsp;&nbsp;&nbsp;Anal√≥gica  Anal√≥gica  Bits    N-bits  Procesam.  Anal√≥gica  Anal√≥gica
                            </p>
                            
                            <p style="margin-top: 15px;"><strong>‚ö†Ô∏è Fuentes de Error en el Proceso Completo:</strong></p>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 0.9em;">
                                <li><strong>Aliasing:</strong> Si fs &lt; 2√ófmax ‚Üí IRREVERSIBLE, distorsi√≥n permanente</li>
                                <li><strong>Cuantificaci√≥n:</strong> Error inherente ‚âà q/‚àö12 RMS ‚Üí IRREVERSIBLE</li>
                                <li><strong>Filtros no ideales:</strong> Atenuaci√≥n, fase, rizado</li>
                                <li><strong>Jitter de muestreo:</strong> Variaciones en Ts ‚Üí Distorsi√≥n</li>
                                <li><strong>Errores de redondeo:</strong> Acumulaci√≥n en procesamiento digital</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>‚úÖ Calidad Final Lograda (Nyquist cumplido):</strong></p>
                            <p style="font-size: 0.9em; margin-top: 8px;">x'(t) ‚âà x(t) + Œµ<sub>total</sub></p>
                            <p style="font-size: 0.9em; margin-top: 6px;">donde Œµtotal = Œµaliasing + Œµcuantificaci√≥n + Œµfiltros + Œµjitter + ...</p>
                        </div>
                    </details>
                </div>
            </div>
        </main>
    </div>

    <!-- ==========================================
         PIE DE P√ÅGINA
    ========================================== -->
    <footer class="pie-pagina">
        <p>üéì Dashboard Educativo | Procesamiento Digital de Se√±ales | 2024</p>
        <p style="font-size: 0.9em; margin-top: 5px;">Movimiento de sliders = Actualizaci√≥n en tiempo real ‚ö°</p>
    </footer>

    <!-- Script principal -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
    <!-- Validaci√≥n de carga -->
    <script>
        // Verificar que Plotly se haya cargado
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof Plotly === 'undefined') {
                console.error('‚ùå Plotly.js no se carg√≥ correctamente');
                alert('‚ö†Ô∏è Error: Plotly.js no se carg√≥. Las gr√°ficas no se mostrar√°n.');
            } else {
                console.log('‚úÖ Plotly.js cargado correctamente');
            }
        });
    </script>
</body>
</html>
